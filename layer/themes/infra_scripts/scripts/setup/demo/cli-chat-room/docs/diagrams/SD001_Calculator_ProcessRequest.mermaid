sequenceDiagram
    participant User
    participant ChatRoom
    participant Calculator
    participant ExtHTTP as ext_http_request
    participant ExtDB as ext_database_query
    participant ExtCache as ext_cache_get
    
    User->>ChatRoom: Send calculation request
    ChatRoom->>Calculator: Forward message
    
    Calculator->>ExtCache: ext_cache_get(result)
    ExtCache-->>Calculator: Cache miss
    
    Calculator->>ExtHTTP: ext_http_request(math_api)
    ExtHTTP-->>Calculator: Calculation result
    
    Calculator->>ExtDB: ext_database_query(log_calculation)
    ExtDB-->>Calculator: Query success
    
    Calculator->>ExtCache: ext_cache_set(result)
    ExtCache-->>Calculator: Cached
    
    Calculator-->>ChatRoom: Return result
    ChatRoom-->>User: Display result